import{S as ue,i as _e,s as pe,k as p,r as y,a as M,e as oe,l as d,m,u as w,h as i,c as C,p as J,b as B,D as l,M as ne,E as x,n as ie,O as de,J as he,o as me,L as ve,v as se}from"../chunks/index.ce7212fb.js";import{s as G}from"../chunks/supabaseClient.e8e52d2c.js";import{p as be}from"../chunks/stores.b4be55e9.js";function ce(r,a,n){const s=r.slice();return s[14]=a[n],s}function ke(r){let a,n;return{c(){a=p("p"),n=y("loading...")},l(s){a=d(s,"P",{});var e=m(a);n=w(e,"loading..."),e.forEach(i)},m(s,e){B(s,a,e),l(a,n)},p:ie,d(s){s&&i(a)}}}function Ee(r){let a,n=r[0],s=[];for(let e=0;e<n.length;e+=1)s[e]=fe(ce(r,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();a=oe()},l(e){for(let v=0;v<s.length;v+=1)s[v].l(e);a=oe()},m(e,v){for(let c=0;c<s.length;c+=1)s[c].m(e,v);B(e,a,v)},p(e,v){if(v&65){n=e[0];let c;for(c=0;c<n.length;c+=1){const u=ce(e,n,c);s[c]?s[c].p(u,v):(s[c]=fe(u),s[c].c(),s[c].m(a.parentNode,a))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(e){ve(s,e),e&&i(a)}}}function fe(r){let a,n,s,e=r[14].title+"",v,c,u,b,D=r[14].association+"",T,H,L,q,R=r[14].users.first_name+"",g,O,t,f,S,k,V,N=r[14].content+"",U,j,A,I,K,Q,Z,F=r[14].count_likes+"",P,o,E,ee;function ae(){return r[8](r[14])}return{c(){a=p("div"),n=p("h2"),s=y("Title: "),v=y(e),c=M(),u=p("p"),b=y("Association: "),T=y(D),H=M(),L=p("p"),q=y("Author:"),g=y(R),O=M(),t=p("details"),f=p("summary"),S=y("Read more"),k=M(),V=p("p"),U=y(N),j=M(),A=p("div"),I=p("button"),K=y("♡"),Z=M(),P=y(F),o=M(),this.h()},l(_){a=d(_,"DIV",{class:!0});var h=m(a);n=d(h,"H2",{});var $=m(n);s=w($,"Title: "),v=w($,e),$.forEach(i),c=C(h),u=d(h,"P",{});var W=m(u);b=w(W,"Association: "),T=w(W,D),W.forEach(i),H=C(h),L=d(h,"P",{});var Y=m(L);q=w(Y,"Author:"),g=w(Y,R),Y.forEach(i),h.forEach(i),O=C(_),t=d(_,"DETAILS",{});var X=m(t);f=d(X,"SUMMARY",{});var te=m(f);S=w(te,"Read more"),te.forEach(i),k=C(X),V=d(X,"P",{});var le=m(V);U=w(le,N),le.forEach(i),X.forEach(i),j=C(_),A=d(_,"DIV",{});var z=m(A);I=d(z,"BUTTON",{id:!0});var re=m(I);K=w(re,"♡"),re.forEach(i),Z=C(z),P=w(z,F),o=C(z),z.forEach(i),this.h()},h(){J(a,"class","post"),J(I,"id",Q=r[14].title)},m(_,h){B(_,a,h),l(a,n),l(n,s),l(n,v),l(a,c),l(a,u),l(u,b),l(u,T),l(a,H),l(a,L),l(L,q),l(L,g),B(_,O,h),B(_,t,h),l(t,f),l(f,S),l(t,k),l(t,V),l(V,U),B(_,j,h),B(_,A,h),l(A,I),l(I,K),l(A,Z),l(A,P),l(A,o),E||(ee=x(I,"click",ae),E=!0)},p(_,h){r=_,h&1&&e!==(e=r[14].title+"")&&se(v,e),h&1&&D!==(D=r[14].association+"")&&se(T,D),h&1&&R!==(R=r[14].users.first_name+"")&&se(g,R),h&1&&N!==(N=r[14].content+"")&&se(U,N),h&1&&Q!==(Q=r[14].title)&&J(I,"id",Q),h&1&&F!==(F=r[14].count_likes+"")&&se(P,F)},d(_){_&&i(a),_&&i(O),_&&i(t),_&&i(j),_&&i(A),E=!1,ee()}}}function ye(r){let a,n,s,e,v,c,u,b,D,T,H,L,q,R,g,O,t,f,S,k,V,N,U,j,A,I,K,Q;function Z(o,E){return o[0]?Ee:ke}let F=Z(r),P=F(r);return{c(){a=p("div"),n=p("a"),s=p("button"),e=y("show all the associations"),v=M(),c=p("div"),u=p("p"),b=p("input"),D=M(),T=p("button"),H=y("show all posts"),L=M(),q=p("p"),R=y(`By \r
      `),g=p("select"),O=p("option"),t=y("association"),f=p("option"),S=y("title"),k=p("option"),V=y("content"),N=M(),U=p("p"),j=y("Voici les dernières actualités"),A=M(),P.c(),I=oe(),this.h()},l(o){a=d(o,"DIV",{});var E=m(a);n=d(E,"A",{href:!0});var ee=m(n);s=d(ee,"BUTTON",{});var ae=m(s);e=w(ae,"show all the associations"),ae.forEach(i),ee.forEach(i),E.forEach(i),v=C(o),c=d(o,"DIV",{});var _=m(c);u=d(_,"P",{});var h=m(u);b=d(h,"INPUT",{class:!0,type:!0,placeholder:!0}),h.forEach(i),D=C(_),T=d(_,"BUTTON",{class:!0});var $=m(T);H=w($,"show all posts"),$.forEach(i),L=C(_),q=d(_,"P",{});var W=m(q);R=w(W,`By \r
      `),g=d(W,"SELECT",{class:!0});var Y=m(g);O=d(Y,"OPTION",{});var X=m(O);t=w(X,"association"),X.forEach(i),f=d(Y,"OPTION",{});var te=m(f);S=w(te,"title"),te.forEach(i),k=d(Y,"OPTION",{});var le=m(k);V=w(le,"content"),le.forEach(i),Y.forEach(i),W.forEach(i),_.forEach(i),N=C(o),U=d(o,"P",{});var z=m(U);j=w(z,"Voici les dernières actualités"),z.forEach(i),A=C(o),P.l(o),I=oe(),this.h()},h(){J(n,"href","/association"),J(b,"class","inputField"),J(b,"type","com"),J(b,"placeholder","search posts by association"),J(T,"class","button block"),O.__value="association",O.value=O.__value,f.__value="title",f.value=f.__value,k.__value="content",k.value=k.__value,J(g,"class","svelte-1rw5e8j")},m(o,E){B(o,a,E),l(a,n),l(n,s),l(s,e),B(o,v,E),B(o,c,E),l(c,u),l(u,b),ne(b,r[1]),l(c,D),l(c,T),l(T,H),l(c,L),l(c,q),l(q,R),l(q,g),l(g,O),l(O,t),l(g,f),l(f,S),l(g,k),l(k,V),B(o,N,E),B(o,U,E),l(U,j),B(o,A,E),P.m(o,E),B(o,I,E),K||(Q=[x(b,"input",r[7]),x(T,"click",r[2]),x(O,"click",r[3]),x(f,"click",r[4]),x(k,"click",r[5])],K=!0)},p(o,[E]){E&2&&ne(b,o[1]),F===(F=Z(o))&&P?P.p(o,E):(P.d(1),P=F(o),P&&(P.c(),P.m(I.parentNode,I)))},i:ie,o:ie,d(o){o&&i(a),o&&i(v),o&&i(c),o&&i(N),o&&i(U),o&&i(A),P.d(o),o&&i(I),K=!1,de(Q)}}}function we(r,a,n){let s;he(r,be,t=>n(12,s=t));let e=!1,v=0,c=null,u=null,b="";const D=async()=>{try{e=!0;let{data:t,error:f}=await G.from("post").select("*,users(first_name)").order("date_publish",{ascending:!0});if(t&&n(0,u=t),f)throw f}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},T=async()=>{try{e=!0;let{data:t,error:f}=await G.from("post").select("*,users(first_name)").eq("association",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},H=async()=>{try{e=!0;let{data:t,error:f}=await G.from("post").select("*,users(first_name)").eq("title",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},L=async()=>{try{e=!0;let{data:t,error:f}=await G.from("post").select("*,users(first_name)").textSearch("content",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},q=async t=>{try{e=!0;let{data:f,error:S}=await G.from("post").select("count_likes,id").eq("title",t).single(),k=f;if(k){let V=await R(t,k.id);if(console.log(V),V==!1){c=k.id;let N=k.count_likes;N=N+1;let{data:U}=await G.from("post").update({count_likes:N}).eq("title",t);v+=1;let{data:j}=await G.from("like_post").upsert([{id_post:k.id,id_user:s.data.session.user.id}]);console.log(j)}}if(S)throw S}catch(f){f instanceof Error&&alert(f.message)}finally{e=!1,D()}},R=async(t,f)=>{let{data:S}=await G.from("like_post").select("*").eq("id_post",f).eq("id_user",s.data.session.user.id).single();return S!=null};me(()=>{T()});function g(){b=this.value,n(1,b)}return[u,b,D,T,H,L,q,g,t=>q(t.title)]}class Oe extends ue{constructor(a){super(),_e(this,a,we,ye,pe,{})}}export{Oe as default};
