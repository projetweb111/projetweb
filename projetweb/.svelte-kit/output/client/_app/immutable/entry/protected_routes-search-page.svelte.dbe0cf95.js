import{S as ue,i as _e,s as pe,k as p,r as y,a as M,e as oe,l as d,m,u as P,h as i,c as C,p as J,b as B,D as l,K as ne,E as x,n as ie,M as de,J as he,o as me,P as ve,v as se}from"../chunks/index.0e58c74b.js";import{s as z}from"../chunks/supabaseClient.e8e52d2c.js";import{p as be}from"../chunks/stores.2f18ef1e.js";function ce(r,a,n){const s=r.slice();return s[14]=a[n],s}function ke(r){let a,n;return{c(){a=p("p"),n=y("loading...")},l(s){a=d(s,"P",{});var e=m(a);n=P(e,"loading..."),e.forEach(i)},m(s,e){B(s,a,e),l(a,n)},p:ie,d(s){s&&i(a)}}}function Ee(r){let a,n=r[0],s=[];for(let e=0;e<n.length;e+=1)s[e]=fe(ce(r,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();a=oe()},l(e){for(let v=0;v<s.length;v+=1)s[v].l(e);a=oe()},m(e,v){for(let c=0;c<s.length;c+=1)s[c].m(e,v);B(e,a,v)},p(e,v){if(v&65){n=e[0];let c;for(c=0;c<n.length;c+=1){const u=ce(e,n,c);s[c]?s[c].p(u,v):(s[c]=fe(u),s[c].c(),s[c].m(a.parentNode,a))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(e){ve(s,e),e&&i(a)}}}function fe(r){let a,n,s,e=r[14].title+"",v,c,u,b,D=r[14].association+"",T,H,S,q,R=r[14].users.first_name+"",g,I,t,f,V,k,L,O=r[14].content+"",U,j,A,N,G,Q,Z,F=r[14].count_likes+"",w,o,E,ee;function ae(){return r[8](r[14])}return{c(){a=p("div"),n=p("h2"),s=y("Title: "),v=y(e),c=M(),u=p("p"),b=y("Association: "),T=y(D),H=M(),S=p("p"),q=y("Author:"),g=y(R),I=M(),t=p("details"),f=p("summary"),V=y("Read more"),k=M(),L=p("p"),U=y(O),j=M(),A=p("div"),N=p("button"),G=y("♡"),Z=M(),w=y(F),o=M(),this.h()},l(_){a=d(_,"DIV",{class:!0});var h=m(a);n=d(h,"H2",{});var $=m(n);s=P($,"Title: "),v=P($,e),$.forEach(i),c=C(h),u=d(h,"P",{});var W=m(u);b=P(W,"Association: "),T=P(W,D),W.forEach(i),H=C(h),S=d(h,"P",{});var K=m(S);q=P(K,"Author:"),g=P(K,R),K.forEach(i),h.forEach(i),I=C(_),t=d(_,"DETAILS",{});var X=m(t);f=d(X,"SUMMARY",{});var te=m(f);V=P(te,"Read more"),te.forEach(i),k=C(X),L=d(X,"P",{});var le=m(L);U=P(le,O),le.forEach(i),X.forEach(i),j=C(_),A=d(_,"DIV",{});var Y=m(A);N=d(Y,"BUTTON",{id:!0});var re=m(N);G=P(re,"♡"),re.forEach(i),Z=C(Y),w=P(Y,F),o=C(Y),Y.forEach(i),this.h()},h(){J(a,"class","post"),J(N,"id",Q=r[14].title)},m(_,h){B(_,a,h),l(a,n),l(n,s),l(n,v),l(a,c),l(a,u),l(u,b),l(u,T),l(a,H),l(a,S),l(S,q),l(S,g),B(_,I,h),B(_,t,h),l(t,f),l(f,V),l(t,k),l(t,L),l(L,U),B(_,j,h),B(_,A,h),l(A,N),l(N,G),l(A,Z),l(A,w),l(A,o),E||(ee=x(N,"click",ae),E=!0)},p(_,h){r=_,h&1&&e!==(e=r[14].title+"")&&se(v,e),h&1&&D!==(D=r[14].association+"")&&se(T,D),h&1&&R!==(R=r[14].users.first_name+"")&&se(g,R),h&1&&O!==(O=r[14].content+"")&&se(U,O),h&1&&Q!==(Q=r[14].title)&&J(N,"id",Q),h&1&&F!==(F=r[14].count_likes+"")&&se(w,F)},d(_){_&&i(a),_&&i(I),_&&i(t),_&&i(j),_&&i(A),E=!1,ee()}}}function ye(r){let a,n,s,e,v,c,u,b,D,T,H,S,q,R,g,I,t,f,V,k,L,O,U,j,A,N,G,Q;function Z(o,E){return o[0]?Ee:ke}let F=Z(r),w=F(r);return{c(){a=p("div"),n=p("a"),s=p("button"),e=y("show all the associations"),v=M(),c=p("div"),u=p("p"),b=p("input"),D=M(),T=p("button"),H=y("show all posts"),S=M(),q=p("p"),R=y(`By 
      `),g=p("select"),I=p("option"),t=y("association"),f=p("option"),V=y("title"),k=p("option"),L=y("content"),O=M(),U=p("p"),j=y("Voici les dernières actualités"),A=M(),w.c(),N=oe(),this.h()},l(o){a=d(o,"DIV",{});var E=m(a);n=d(E,"A",{href:!0});var ee=m(n);s=d(ee,"BUTTON",{});var ae=m(s);e=P(ae,"show all the associations"),ae.forEach(i),ee.forEach(i),E.forEach(i),v=C(o),c=d(o,"DIV",{});var _=m(c);u=d(_,"P",{});var h=m(u);b=d(h,"INPUT",{class:!0,type:!0,placeholder:!0}),h.forEach(i),D=C(_),T=d(_,"BUTTON",{class:!0});var $=m(T);H=P($,"show all posts"),$.forEach(i),S=C(_),q=d(_,"P",{});var W=m(q);R=P(W,`By 
      `),g=d(W,"SELECT",{class:!0});var K=m(g);I=d(K,"OPTION",{});var X=m(I);t=P(X,"association"),X.forEach(i),f=d(K,"OPTION",{});var te=m(f);V=P(te,"title"),te.forEach(i),k=d(K,"OPTION",{});var le=m(k);L=P(le,"content"),le.forEach(i),K.forEach(i),W.forEach(i),_.forEach(i),O=C(o),U=d(o,"P",{});var Y=m(U);j=P(Y,"Voici les dernières actualités"),Y.forEach(i),A=C(o),w.l(o),N=oe(),this.h()},h(){J(n,"href","/association"),J(b,"class","inputField"),J(b,"type","com"),J(b,"placeholder","search posts by association"),J(T,"class","button block"),I.__value="association",I.value=I.__value,f.__value="title",f.value=f.__value,k.__value="content",k.value=k.__value,J(g,"class","svelte-1rw5e8j")},m(o,E){B(o,a,E),l(a,n),l(n,s),l(s,e),B(o,v,E),B(o,c,E),l(c,u),l(u,b),ne(b,r[1]),l(c,D),l(c,T),l(T,H),l(c,S),l(c,q),l(q,R),l(q,g),l(g,I),l(I,t),l(g,f),l(f,V),l(g,k),l(k,L),B(o,O,E),B(o,U,E),l(U,j),B(o,A,E),w.m(o,E),B(o,N,E),G||(Q=[x(b,"input",r[7]),x(T,"click",r[2]),x(I,"click",r[3]),x(f,"click",r[4]),x(k,"click",r[5])],G=!0)},p(o,[E]){E&2&&ne(b,o[1]),F===(F=Z(o))&&w?w.p(o,E):(w.d(1),w=F(o),w&&(w.c(),w.m(N.parentNode,N)))},i:ie,o:ie,d(o){o&&i(a),o&&i(v),o&&i(c),o&&i(O),o&&i(U),o&&i(A),w.d(o),o&&i(N),G=!1,de(Q)}}}function Pe(r,a,n){let s;he(r,be,t=>n(12,s=t));let e=!1,v=0,c=null,u=null,b="";const D=async()=>{try{e=!0;let{data:t,error:f}=await z.from("post").select("*,users(first_name)").order("date_publish",{ascending:!0});if(t&&n(0,u=t),f)throw f}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},T=async()=>{try{e=!0;let{data:t,error:f}=await z.from("post").select("*,users(first_name)").eq("association",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},H=async()=>{try{e=!0;let{data:t,error:f}=await z.from("post").select("*,users(first_name)").eq("title",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},S=async()=>{try{e=!0;let{data:t,error:f}=await z.from("post").select("*,users(first_name)").textSearch("content",b).order("date_publish",{ascending:!0});console.log(u),t&&(n(0,u=t),console.table(u))}catch(t){t instanceof Error&&alert(t.message)}finally{e=!1}},q=async t=>{try{e=!0;let{data:f,error:V}=await z.from("post").select("count_likes,id").eq("title",t).single(),k=f;if(k){let L=await R(t,k.id);if(console.log(L),L==!1){c=k.id;let O=k.count_likes;O=O+1;let{data:U}=await z.from("post").update({count_likes:O}).eq("title",t);v+=1;let{data:j}=await z.from("like_post").upsert([{id_post:k.id,id_user:s.data.session.user.id}]);console.log(j)}}if(V)throw V}catch(f){f instanceof Error&&alert(f.message)}finally{e=!1,D()}},R=async(t,f)=>{let{data:V}=await z.from("like_post").select("*").eq("id_post",f).eq("id_user",s.data.session.user.id).single();return V!=null};me(()=>{T()});function g(){b=this.value,n(1,b)}return[u,b,D,T,H,S,q,g,t=>q(t.title)]}class Ie extends ue{constructor(a){super(),_e(this,a,Pe,ye,pe,{})}}export{Ie as default};
