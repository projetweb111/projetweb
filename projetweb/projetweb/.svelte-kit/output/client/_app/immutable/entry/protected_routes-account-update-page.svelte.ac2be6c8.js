import{S as Me,i as qe,s as Ce,k as a,r as w,a as m,l as s,m as p,u as L,h as n,c as _,p as t,b as Ee,D as e,M,E as x,N as Oe,v as Ve,n as Te,O as Re,J as He,o as Je}from"../chunks/index.ce7212fb.js";import{g as je}from"../chunks/navigation.d267f952.js";import{p as ze}from"../chunks/stores.37c6b56c.js";import{s as Ue}from"../chunks/supabaseClient.e8e52d2c.js";function Ge(o){let g,u,H,q,h,d,b,S,J,C,E,P,k,v,I,W,B,V,X,Y,O,r,j,R,se,re,T,f,z,oe,ue,y,ne,G,fe,ie,A,pe,K,de,ce,D,me,Q,_e,he,F,ve,Z,N,$,be,we;return{c(){g=a("form"),u=a("h1"),H=w("Edit my account"),q=m(),h=a("form"),d=a("div"),b=a("div"),S=a("label"),J=w("Email"),C=m(),E=a("p"),P=w(o[3]),k=m(),v=a("a"),I=w("Change email and password"),W=m(),B=a("div"),V=a("label"),X=w("Status"),Y=m(),O=a("p"),r=w(o[4]),j=m(),R=a("a"),se=w("Ask for a new status"),re=m(),T=a("div"),f=a("div"),z=a("label"),oe=w("First name"),ue=m(),y=a("input"),ne=m(),G=a("label"),fe=w("Last name"),ie=m(),A=a("input"),pe=m(),K=a("label"),de=w("Pseudo"),ce=m(),D=a("input"),me=m(),Q=a("label"),_e=w("Promo"),he=m(),F=a("input"),ve=m(),Z=a("div"),N=a("input"),this.h()},l(l){g=s(l,"FORM",{class:!0});var i=p(g);u=s(i,"H1",{});var Le=p(u);H=L(Le,"Edit my account"),Le.forEach(n),i.forEach(n),q=_(l),h=s(l,"FORM",{class:!0});var ee=p(h);d=s(ee,"DIV",{class:!0});var U=p(d);b=s(U,"DIV",{});var te=p(b);S=s(te,"LABEL",{for:!0});var ge=p(S);J=L(ge,"Email"),ge.forEach(n),C=_(te),E=s(te,"P",{});var Pe=p(E);P=L(Pe,o[3]),Pe.forEach(n),te.forEach(n),k=_(U),v=s(U,"A",{class:!0,href:!0});var Ie=p(v);I=L(Ie,"Change email and password"),Ie.forEach(n),W=_(U),B=s(U,"DIV",{});var le=p(B);V=s(le,"LABEL",{for:!0});var ye=p(V);X=L(ye,"Status"),ye.forEach(n),Y=_(le),O=s(le,"P",{});var Ae=p(O);r=L(Ae,o[4]),Ae.forEach(n),le.forEach(n),j=_(U),R=s(U,"A",{class:!0,href:!0});var De=p(R);se=L(De,"Ask for a new status"),De.forEach(n),U.forEach(n),re=_(ee),T=s(ee,"DIV",{class:!0});var ae=p(T);f=s(ae,"DIV",{});var c=p(f);z=s(c,"LABEL",{for:!0});var Fe=p(z);oe=L(Fe,"First name"),Fe.forEach(n),ue=_(c),y=s(c,"INPUT",{class:!0,type:!0,placeholder:!0}),ne=_(c),G=s(c,"LABEL",{for:!0});var Se=p(G);fe=L(Se,"Last name"),Se.forEach(n),ie=_(c),A=s(c,"INPUT",{class:!0,type:!0,placeholder:!0}),pe=_(c),K=s(c,"LABEL",{for:!0});var ke=p(K);de=L(ke,"Pseudo"),ke.forEach(n),ce=_(c),D=s(c,"INPUT",{class:!0,type:!0,placeholder:!0}),me=_(c),Q=s(c,"LABEL",{for:!0});var Be=p(Q);_e=L(Be,"Promo"),Be.forEach(n),he=_(c),F=s(c,"INPUT",{class:!0,type:!0,placeholder:!0}),c.forEach(n),ve=_(ae),Z=s(ae,"DIV",{});var Ne=p(Z);N=s(Ne,"INPUT",{type:!0,class:!0}),Ne.forEach(n),ae.forEach(n),ee.forEach(n),this.h()},h(){t(g,"class","row flex-center flex"),t(S,"for","email"),t(v,"class","button block"),t(v,"href","/protected_routes/account/auth"),t(V,"for","status"),t(R,"class","button block"),t(R,"href","/protected_routes/account/status"),t(d,"class","col-7 form-widget"),t(z,"for","first_name"),t(y,"class","inputField"),t(y,"type","first_name"),t(y,"placeholder",o[0]),t(G,"for","last_name"),t(A,"class","inputField"),t(A,"type","last_name"),t(A,"placeholder",o[1]),t(K,"for","pseudo"),t(D,"class","inputField"),t(D,"type","pseudo"),t(D,"placeholder",o[2]),t(Q,"for","promo"),t(F,"class","inputField"),t(F,"type","promo"),t(F,"placeholder",o[5]),t(N,"type","submit"),t(N,"class","button block primary"),N.value=$=o[10]?"Loading":"Save",N.disabled=o[10],t(T,"class","col-8 form-widget"),t(h,"class","row flex-center flex")},m(l,i){Ee(l,g,i),e(g,u),e(u,H),Ee(l,q,i),Ee(l,h,i),e(h,d),e(d,b),e(b,S),e(S,J),e(b,C),e(b,E),e(E,P),e(d,k),e(d,v),e(v,I),e(d,W),e(d,B),e(B,V),e(V,X),e(B,Y),e(B,O),e(O,r),e(d,j),e(d,R),e(R,se),e(h,re),e(h,T),e(T,f),e(f,z),e(z,oe),e(f,ue),e(f,y),M(y,o[6]),e(f,ne),e(f,G),e(G,fe),e(f,ie),e(f,A),M(A,o[7]),e(f,pe),e(f,K),e(K,de),e(f,ce),e(f,D),M(D,o[8]),e(f,me),e(f,Q),e(Q,_e),e(f,he),e(f,F),M(F,o[9]),e(T,ve),e(T,Z),e(Z,N),be||(we=[x(y,"input",o[12]),x(A,"input",o[13]),x(D,"input",o[14]),x(F,"input",o[15]),x(h,"submit",Oe(o[11]))],be=!0)},p(l,[i]){i&8&&Ve(P,l[3]),i&16&&Ve(r,l[4]),i&1&&t(y,"placeholder",l[0]),i&64&&M(y,l[6]),i&2&&t(A,"placeholder",l[1]),i&128&&M(A,l[7]),i&4&&t(D,"placeholder",l[2]),i&256&&M(D,l[8]),i&32&&t(F,"placeholder",l[5]),i&512&&M(F,l[9]),i&1024&&$!==($=l[10]?"Loading":"Save")&&(N.value=$),i&1024&&(N.disabled=l[10])},i:Te,o:Te,d(l){l&&n(g),l&&n(q),l&&n(h),be=!1,Re(we)}}}function Ke(o,g,u){let H;He(o,ze,r=>u(16,H=r));let q=H.data.session.user,h=null,d=null,b=null,S=null,J=null,C=null,E=null,P=null,k=null,v=null,I=!1;async function W(){try{u(10,I=!0);let{error:r}=await Ue.from("users").update({first_name:E||h,last_name:P||d,pseudo:k||b,promo:v||C}).eq("id",q.id);if(r)throw r;u(10,I=!1),je("/protected_routes/account")}catch(r){r instanceof Error&&alert(r.message)}finally{u(10,I=!1)}}Je(()=>{B()});const B=async()=>{try{u(10,I=!0);let{data:r,error:j}=await Ue.from("users").select("first_name, last_name, pseudo, email, status, promo").eq("id",q.id).single();if(r&&(u(0,h=r.first_name),u(1,d=r.last_name),u(2,b=r.pseudo),u(3,S=r.email),u(4,J=r.status),u(5,C=r.promo)),j)throw j}catch(r){r instanceof Error&&alert(r.message)}finally{u(10,I=!1)}};function V(){E=this.value,u(6,E)}function X(){P=this.value,u(7,P)}function Y(){k=this.value,u(8,k)}function O(){v=this.value,u(9,v)}return[h,d,b,S,J,C,E,P,k,v,I,W,V,X,Y,O]}class Ze extends Me{constructor(g){super(),qe(this,g,Ke,Ge,Ce,{})}}export{Ze as default};
